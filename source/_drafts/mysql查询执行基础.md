---
title: mysql查询执行基础
abbrlink: b5a20f44
categories:
  - 数据库
  - mysql
date: 2019-03-30 15:41:44
tags:
copyright:
---
本篇文章主要介绍mysql是如何执行优化和查询，也就是对mysql执行sql语句的整个流程进行分析。通过理解mysql执行的流程。可以帮助我们理解很多查询优化工作其实就是遵循一些原则让优化器能够按照预想的合理的方式运行。

主要内容如下
1. 查询流程简单介绍
2. mysql客户端/服务端通信协议
3. 查询缓存
4. 查询优化处理
5. 查询执行引擎
6. 返回结果给客户端

## 查询流程简单介绍
mysql执行一个查询的过程如下图：

![Xnip2019-03-30_16-12-37](/source/images/Xnip2019-03-30_16-12-37.jpg)
从上图，可以看出mysql整个执行流程如下：
1. 客户端发送一条查询给服务器
2. 服务器先检查查询缓存，如果命中了缓存，则立刻返回存储在缓存中的结果，否则进入下一个阶段。
3. 服务器进行SQL解析、预处理，在由优化器生成对应的执行计划。
4. MySql根据优化器生成的执行计划，调用存储引擎的API来执行查询。
5. 将结果返回给客户端

上面的每一步都比较复杂，下面将对上面的每一步进行具体的讨论。其中查询优化是比较复杂也特别难理解的地方。

